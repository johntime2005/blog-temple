---
import { getCollection } from "astro:content";
import PostCard from "@components/PostCard.astro";
import MainGridLayout from "@layouts/MainGridLayout.astro";

// è·å–æ‰€æœ‰tutorialsç›®å½•ä¸‹çš„æ•™ç¨‹æ–‡ç« 
const allPosts = await getCollection("posts", ({ data }) => {
	return !data.draft;
});

// è¿‡æ»¤å‡º tutorials ç›®å½•ä¸‹çš„æ–‡ç« 
const allTutorials = allPosts.filter((post) => {
	return post.id.startsWith("tutorials/");
});

// æŒ‰å‘å¸ƒæ—¥æœŸæ’åº
const sortedTutorials = allTutorials.sort((a, b) => {
	const dateA = new Date(a.data.published);
	const dateB = new Date(b.data.published);
	return dateB.getTime() - dateA.getTime();
});

// æŒ‰åˆ†ç±»åˆ†ç»„
const tutorialsByCategory = sortedTutorials.reduce(
	(acc, post) => {
		const category = post.data.category || "å…¶ä»–";
		if (!acc[category]) {
			acc[category] = [];
		}
		acc[category].push(post);
		return acc;
	},
	{} as Record<string, typeof sortedTutorials>,
);

const pageTitle = "ğŸ“š Firefly ä½¿ç”¨æ•™ç¨‹";
const pageDescription = "å­¦ä¹ å¦‚ä½•ä½¿ç”¨å’Œé…ç½® Firefly åšå®¢ä¸»é¢˜";
---

<MainGridLayout title={pageTitle} description={pageDescription}>
	<div class="card-base px-8 py-8">
		<!-- é¡µé¢æ ‡é¢˜ -->
		<h1
			class="text-4xl font-bold mb-4 text-neutral-900 dark:text-neutral-100"
		>
			ğŸ“š Firefly ä½¿ç”¨æ•™ç¨‹
		</h1>
		<p class="text-neutral-700 dark:text-neutral-300 mb-8">
			æ¬¢è¿æ¥åˆ° Firefly ä½¿ç”¨æ•™ç¨‹ï¼è¿™é‡Œæ”¶å½•äº†æ‰€æœ‰å…³äº Firefly
			åšå®¢ä¸»é¢˜çš„ä½¿ç”¨æŒ‡å—å’Œç¤ºä¾‹æ–‡ç« ã€‚
		</p>

		<!-- GitHub é¡¹ç›®å¡ç‰‡ -->
		<div
			class="mb-12 p-6 rounded-lg bg-gradient-to-r from-blue-50 to-purple-50 dark:from-blue-900/20 dark:to-purple-900/20 border border-blue-200 dark:border-blue-800"
		>
			<div class="flex items-start gap-4">
				<div class="flex-shrink-0">
					<svg
						class="w-12 h-12 text-blue-600 dark:text-blue-400"
						fill="currentColor"
						viewBox="0 0 24 24"
					>
						<path
							d="M12 0C5.37 0 0 5.37 0 12c0 5.31 3.435 9.795 8.205 11.385.6.105.825-.255.825-.57 0-.285-.015-1.23-.015-2.235-3.015.555-3.795-.735-4.035-1.41-.135-.345-.72-1.41-1.23-1.695-.42-.225-1.02-.78-.015-.795.945-.015 1.62.87 1.845 1.23 1.08 1.815 2.805 1.305 3.495.99.105-.78.42-1.305.765-1.605-2.67-.3-5.46-1.335-5.46-5.925 0-1.305.465-2.385 1.23-3.225-.12-.3-.54-1.53.12-3.18 0 0 1.005-.315 3.3 1.23.96-.27 1.98-.405 3-.405s2.04.135 3 .405c2.295-1.56 3.3-1.23 3.3-1.23.66 1.65.24 2.88.12 3.18.765.84 1.23 1.905 1.23 3.225 0 4.605-2.805 5.625-5.475 5.925.435.375.81 1.095.81 2.22 0 1.605-.015 2.895-.015 3.3 0 .315.225.69.825.57A12.02 12.02 0 0024 12c0-6.63-5.37-12-12-12z"
						></path>
					</svg>
				</div>
				<div class="flex-1">
					<h2
						class="text-2xl font-bold mb-2 text-neutral-900 dark:text-neutral-100"
					>
						ğŸŒŸ Firefly - Astro åšå®¢ä¸»é¢˜
					</h2>
					<p class="text-neutral-700 dark:text-neutral-300 mb-4">
						ä¸€æ¬¾æ¸…æ–°ç¾è§‚ä¸”ç°ä»£åŒ–çš„ä¸ªäººåšå®¢ä¸»é¢˜ï¼Œä¸“ä¸ºæŠ€æœ¯çˆ±å¥½è€…å’Œå†…å®¹åˆ›ä½œè€…è®¾è®¡ã€‚
					</p>
					<div class="flex flex-wrap gap-3">
						<a
							href="https://github.com/CuteLeaf/Firefly"
							target="_blank"
							rel="noopener noreferrer"
							class="inline-flex items-center gap-2 px-4 py-2 bg-neutral-900 dark:bg-neutral-100 text-white dark:text-neutral-900 rounded-lg hover:bg-neutral-800 dark:hover:bg-neutral-200 transition-colors"
						>
							<svg
								class="w-5 h-5"
								fill="currentColor"
								viewBox="0 0 24 24"
							>
								<path
									d="M12 0C5.37 0 0 5.37 0 12c0 5.31 3.435 9.795 8.205 11.385.6.105.825-.255.825-.57 0-.285-.015-1.23-.015-2.235-3.015.555-3.795-.735-4.035-1.41-.135-.345-.72-1.41-1.23-1.695-.42-.225-1.02-.78-.015-.795.945-.015 1.62.87 1.845 1.23 1.08 1.815 2.805 1.305 3.495.99.105-.78.42-1.305.765-1.605-2.67-.3-5.46-1.335-5.46-5.925 0-1.305.465-2.385 1.23-3.225-.12-.3-.54-1.53.12-3.18 0 0 1.005-.315 3.3 1.23.96-.27 1.98-.405 3-.405s2.04.135 3 .405c2.295-1.56 3.3-1.23 3.3-1.23.66 1.65.24 2.88.12 3.18.765.84 1.23 1.905 1.23 3.225 0 4.605-2.805 5.625-5.475 5.925.435.375.81 1.095.81 2.22 0 1.605-.015 2.895-.015 3.3 0 .315.225.69.825.57A12.02 12.02 0 0024 12c0-6.63-5.37-12-12-12z"
								></path>
							</svg>
							æŸ¥çœ‹æºç 
						</a>
						<a
							href="https://docs-firefly.cuteleaf.cn"
							target="_blank"
							rel="noopener noreferrer"
							class="inline-flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors"
						>
							<svg
								class="w-5 h-5"
								fill="none"
								stroke="currentColor"
								viewBox="0 0 24 24"
							>
								<path
									stroke-linecap="round"
									stroke-linejoin="round"
									stroke-width="2"
									d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"
								></path>
							</svg>
							åœ¨çº¿æ–‡æ¡£
						</a>
						<a
							href="https://demo-firefly.netlify.app/"
							target="_blank"
							rel="noopener noreferrer"
							class="inline-flex items-center gap-2 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors"
						>
							<svg
								class="w-5 h-5"
								fill="none"
								stroke="currentColor"
								viewBox="0 0 24 24"
							>
								<path
									stroke-linecap="round"
									stroke-linejoin="round"
									stroke-width="2"
									d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
								<path
									stroke-linecap="round"
									stroke-linejoin="round"
									stroke-width="2"
									d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"
								></path>
							</svg>
							åœ¨çº¿é¢„è§ˆ
						</a>
					</div>
				</div>
			</div>
		</div>

		<!-- æ•™ç¨‹åˆ—è¡¨ -->
		<div class="space-y-8">
			{
				Object.entries(tutorialsByCategory).map(([category, posts]) => (
					<div>
						<h2 class="text-2xl font-bold mb-4 text-neutral-900 dark:text-neutral-100 flex items-center gap-2">
							<span class="text-blue-600 dark:text-blue-400">
								ğŸ“–
							</span>
							{category}
						</h2>
						<div class="grid grid-cols-1 md:grid-cols-2 gap-4">
							{posts.map((post) => (
								<PostCard
									entry={post}
									title={post.data.title}
									url={`/posts/${post.id}/`}
									published={post.data.published}
									tags={post.data.tags}
									category={post.data.category}
									description={post.data.description}
									image={post.data.image}
									draft={post.data.draft}
									pinned={post.data.pinned}
								/>
							))}
						</div>
					</div>
				))
			}
		</div>

		<!-- åº•éƒ¨æç¤º -->
		<div
			class="mt-12 p-6 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg"
		>
			<div class="flex items-start gap-3">
				<svg
					class="w-6 h-6 text-yellow-600 dark:text-yellow-400 flex-shrink-0 mt-0.5"
					fill="none"
					stroke="currentColor"
					viewBox="0 0 24 24"
				>
					<path
						stroke-linecap="round"
						stroke-linejoin="round"
						stroke-width="2"
						d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"
					></path>
				</svg>
				<div>
					<h3
						class="font-bold text-neutral-900 dark:text-neutral-100 mb-1"
					>
						ğŸ’¡ æç¤º
					</h3>
					<p class="text-neutral-700 dark:text-neutral-300 text-sm">
						è¿™äº›æ•™ç¨‹æ–‡ç« ä»…åœ¨æ­¤é¡µé¢æ˜¾ç¤ºï¼Œä¸ä¼šå‡ºç°åœ¨åšå®¢ä¸»é¡µä¸­ã€‚å¦‚æœ‰é—®é¢˜ï¼Œæ¬¢è¿è®¿é—®
						<a
							href="https://github.com/CuteLeaf/Firefly/issues"
							target="_blank"
							rel="noopener noreferrer"
							class="text-blue-600 dark:text-blue-400 hover:underline"
						>
							GitHub Issues
						</a>
						åé¦ˆã€‚
					</p>
				</div>
			</div>
		</div>
	</div>
</MainGridLayout>
