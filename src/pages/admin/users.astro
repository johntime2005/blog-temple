---
import UserManagement from "@components/auth/UserManagement.svelte";
import Layout from "@layouts/Layout.astro";
---

<Layout
	title="ç”¨æˆ·ç®¡ç†åå°"
	description="ç®¡ç†ç”¨æˆ·è´¦æˆ·"
>
	<div class="admin-container">
		<div class="admin-content">
			<div class="header">
				<h1>ç”¨æˆ·ç®¡ç†</h1>
				<p>åˆ›å»ºå’Œç®¡ç†åšå®¢ç”¨æˆ·è´¦æˆ·</p>
			</div>

			<UserManagement client:load adminToken="" />

			<div class="instructions">
				<h3>ğŸ“ ä½¿ç”¨è¯´æ˜</h3>
				<ul>
					<li>åªæœ‰ç®¡ç†å‘˜å¯ä»¥åˆ›å»ºæ–°ç”¨æˆ·</li>
					<li>ç”¨æˆ·ååªèƒ½åŒ…å«å­—æ¯ã€æ•°å­—å’Œä¸‹åˆ’çº¿ï¼Œé•¿åº¦3-20ä¸ªå­—ç¬¦</li>
					<li>å¯†ç é•¿åº¦è‡³å°‘ä¸º6ä¸ªå­—ç¬¦</li>
					<li>å¯ä»¥ä½¿ç”¨"ç”Ÿæˆéšæœºå¯†ç "åŠŸèƒ½åˆ›å»ºå®‰å…¨çš„éšæœºå¯†ç </li>
					<li>åˆ›å»ºçš„ç”¨æˆ·å¯ä»¥ç™»å½•è®¿é—®å—ä¿æŠ¤çš„å†…å®¹ï¼ˆå¦‚æ—¥è®°ï¼‰</li>
				</ul>

				<h3>âš™ï¸ é…ç½®æ­¥éª¤</h3>
				<ol>
					<li>å…ˆè®¿é—® <a href="/admin/encryption">/admin/encryption</a> ç™»å½•ç®¡ç†åå°è·å– admin token</li>
					<li>åœ¨æµè§ˆå™¨æ§åˆ¶å°ä¸­è¿è¡Œ <code>localStorage.getItem('admin-token')</code> è·å– token</li>
					<li>ä¿®æ”¹æœ¬é¡µé¢ä»£ç ï¼Œå°† adminToken è®¾ç½®ä¸ºè·å–åˆ°çš„ token å€¼</li>
					<li>æˆ–è€…ä¿®æ”¹ UserManagement ç»„ä»¶ï¼Œä» localStorage è‡ªåŠ¨è¯»å– token</li>
				</ol>

				<h3>ğŸ” æƒé™è¯´æ˜</h3>
				<p>æ–‡ç« çš„ <code>accessLevel</code> å­—æ®µæ§åˆ¶è®¿é—®æƒé™ï¼š</p>
				<ul>
					<li><code>public</code> - æ‰€æœ‰äººå¯è®¿é—®ï¼ˆé»˜è®¤ï¼‰</li>
					<li><code>members-only</code> - ä»…ç™»å½•ç”¨æˆ·å¯è®¿é—®</li>
					<li><code>restricted</code> - ä»…ç‰¹å®šç”¨æˆ·å¯è®¿é—®ï¼ˆæœªæ¥æ‰©å±•ï¼‰</li>
				</ul>
			</div>
		</div>
	</div>
</Layout>

<style>
	.admin-container {
		min-height: 100vh;
		background: var(--page-bg);
		padding: 2rem 1rem;
	}

	.admin-content {
		max-width: 1200px;
		margin: 0 auto;
	}

	.header {
		margin-bottom: 2rem;
		text-align: center;
	}

	.header h1 {
		font-size: 2rem;
		margin-bottom: 0.5rem;
		color: var(--text-color);
	}

	.header p {
		color: var(--text-secondary);
		font-size: 1rem;
	}

	.instructions {
		background: var(--card-bg);
		border-radius: 12px;
		padding: 2rem;
		margin-top: 2rem;
		box-shadow: var(--shadow-md);
	}

	.instructions h3 {
		margin-top: 0;
		margin-bottom: 1rem;
		color: var(--text-color);
		font-size: 1.125rem;
	}

	.instructions h3:not(:first-child) {
		margin-top: 2rem;
	}

	.instructions ul,
	.instructions ol {
		margin: 0.5rem 0;
		padding-left: 1.5rem;
	}

	.instructions li {
		margin: 0.5rem 0;
		color: var(--text-secondary);
		line-height: 1.6;
	}

	.instructions p {
		margin: 0.5rem 0;
		color: var(--text-secondary);
		line-height: 1.6;
	}

	.instructions code {
		background: var(--page-bg);
		padding: 0.125rem 0.375rem;
		border-radius: 4px;
		font-family: 'Courier New', monospace;
		font-size: 0.875rem;
		color: var(--primary);
	}

	.instructions a {
		color: var(--primary);
		text-decoration: none;
		transition: opacity 0.2s ease;
	}

	.instructions a:hover {
		opacity: 0.8;
		text-decoration: underline;
	}
</style>

<script>
	// è‡ªåŠ¨ä» localStorage è¯»å– admin token å¹¶è®¾ç½®
	const adminToken = localStorage.getItem('admin-token');
	if (adminToken) {
		// æ‰¾åˆ° UserManagement ç»„ä»¶å¹¶è®¾ç½® token
		const userMgmt = document.querySelector('[data-user-management]');
		if (userMgmt) {
			// Svelte ç»„ä»¶ä¼šåœ¨å®¢æˆ·ç«¯åŠ è½½åæ¥æ”¶è¿™ä¸ªå€¼
			(userMgmt as any).__adminToken = adminToken;
		}
	}
</script>
