# ğŸ” æ–‡ç« åŠ å¯†ç³»ç»Ÿ - å®Œæ•´ä½¿ç”¨æŒ‡å—

> **çœŸæ­£çš„æœåŠ¡ç«¯åŠ å¯†æ–¹æ¡ˆ**
> åŸºäº Cloudflare Workers + KV å­˜å‚¨ï¼Œå¯†ç å®‰å…¨å­˜å‚¨åœ¨äº‘ç«¯ï¼Œå‰åç«¯åˆ†ç¦»éªŒè¯

---

## ğŸ“– ç›®å½•

1. [åŠŸèƒ½ç‰¹æ€§](#åŠŸèƒ½ç‰¹æ€§)
2. [å·¥ä½œåŸç†](#å·¥ä½œåŸç†)
3. [é…ç½®æ­¥éª¤](#é…ç½®æ­¥éª¤)
4. [ä½¿ç”¨æµç¨‹](#ä½¿ç”¨æµç¨‹)
5. [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)
6. [å®‰å…¨è¯´æ˜](#å®‰å…¨è¯´æ˜)

---

## åŠŸèƒ½ç‰¹æ€§

### âœ… çœŸæ­£çš„å®‰å…¨

- **å¯†ç ä¸åœ¨ Git ä¸­å­˜å‚¨**ï¼šå¯†ç å­˜å‚¨åœ¨ Cloudflare KVï¼Œæ°¸è¿œä¸ä¼šæäº¤åˆ°ä»£ç ä»“åº“
- **æœåŠ¡ç«¯éªŒè¯**ï¼šå¯†ç éªŒè¯åœ¨ Cloudflare Workers ä¸­è¿›è¡Œï¼Œæ— æ³•è¢«å‰ç«¯ç»•è¿‡
- **SHA-256 å“ˆå¸Œ**ï¼šå¯†ç ä»¥å“ˆå¸Œå½¢å¼å­˜å‚¨ï¼Œå³ä½¿ KV æ³„éœ²ä¹Ÿæ— æ³•åæ¨åŸå¯†ç 
- **ä¸´æ—¶ä»¤ç‰Œæœºåˆ¶**ï¼šéªŒè¯æˆåŠŸåç”Ÿæˆä¸´æ—¶ä»¤ç‰Œï¼ˆ1 å°æ—¶æœ‰æ•ˆï¼‰ï¼Œå‡å°‘å¯†ç ä¼ è¾“

### âš¡ ä¼˜ç§€çš„ä½“éªŒ

- **ç¾è§‚çš„ UI**ï¼šç°ä»£åŒ–çš„å¯†ç è¾“å…¥ç•Œé¢
- **è‡ªåŠ¨è®°å¿†**ï¼šéªŒè¯æˆåŠŸåä¿å­˜ä»¤ç‰Œåˆ°æœ¬åœ°å­˜å‚¨ï¼Œ1 å°æ—¶å†…æ— éœ€é‡å¤è¾“å…¥
- **å³æ—¶åé¦ˆ**ï¼šå¯†ç é”™è¯¯æ—¶ç«‹å³æç¤ºï¼Œæ— éœ€ç­‰å¾…é¡µé¢åˆ·æ–°
- **æ— æ„Ÿé›†æˆ**ï¼šå¯¹æœªåŠ å¯†æ–‡ç« å®Œå…¨é€æ˜ï¼Œä¸å½±å“æ­£å¸¸é˜…è¯»

---

## å·¥ä½œåŸç†

```mermaid
sequenceDiagram
    participant U as ç”¨æˆ·æµè§ˆå™¨
    participant W as Cloudflare Workers
    participant K as Cloudflare KV
    participant S as é™æ€é¡µé¢

    U->>S: è®¿é—®åŠ å¯†æ–‡ç« 
    S-->>U: æ˜¾ç¤ºæ¨¡ç³Šå†…å®¹ + å¯†ç è¾“å…¥æ¡†
    U->>W: POST /api/verify-password (encryptionId, password)
    W->>K: æŸ¥è¯¢å­˜å‚¨çš„å¯†ç å“ˆå¸Œ
    K-->>W: è¿”å›å¯†ç å“ˆå¸Œ
    W->>W: è®¡ç®—è¾“å…¥å¯†ç å“ˆå¸Œå¹¶æ¯”è¾ƒ
    alt å¯†ç æ­£ç¡®
        W->>K: ç”Ÿæˆå¹¶å­˜å‚¨ä¸´æ—¶ä»¤ç‰Œ
        W-->>U: è¿”å› token
        U->>U: ä¿å­˜ token åˆ° localStorage
        U->>U: åˆ·æ–°é¡µé¢ï¼Œæ˜¾ç¤ºå†…å®¹
    else å¯†ç é”™è¯¯
        W-->>U: è¿”å›é”™è¯¯ä¿¡æ¯
        U->>U: æ˜¾ç¤ºé”™è¯¯æç¤º
    end
```

---

## é…ç½®æ­¥éª¤

### æ­¥éª¤ 1ï¼šåˆ›å»º Cloudflare KV å‘½åç©ºé—´

1. ç™»å½• [Cloudflare Dashboard](https://dash.cloudflare.com/)
2. è¿›å…¥ **Workers & Pages** â†’ **KV**
3. ç‚¹å‡» **Create namespace**
4. å‘½åä¸ºï¼š`POST_ENCRYPTION`
5. åˆ›å»ºæˆåŠŸåï¼Œè®°å½• **Namespace ID**ï¼ˆç±»ä¼¼ `abc123def456...`ï¼‰

### æ­¥éª¤ 2ï¼šé…ç½® wrangler.tomlï¼ˆé‡è¦ï¼‰

âš ï¸ **ä½ çš„é¡¹ç›®é€šè¿‡ `wrangler.toml` ç®¡ç†é…ç½®ï¼Œä¸èƒ½åœ¨ Dashboard ä¸­æ‰‹åŠ¨ç»‘å®šï¼**

æ‰“å¼€é¡¹ç›®æ ¹ç›®å½•çš„ `wrangler.toml` æ–‡ä»¶ï¼Œå°† Namespace ID å¡«å…¥ï¼š

```toml
name = "blog"
compatibility_date = "2025-11-18"

[[kv_namespaces]]
binding = "POST_ENCRYPTION"
id = "abc123def456789"  # â† æ›¿æ¢ä¸ºä½ çš„ KV Namespace ID
```

**è¯¦ç»†é…ç½®æ­¥éª¤ï¼š** æŸ¥çœ‹ [WRANGLER_SETUP.md](./WRANGLER_SETUP.md)

### æ­¥éª¤ 3ï¼šæäº¤å¹¶éƒ¨ç½²

```bash
# æ·»åŠ é…ç½®æ–‡ä»¶
git add wrangler.toml

# æäº¤
git commit -m "feat: æ·»åŠ  KV ç»‘å®šé…ç½®ç”¨äºæ–‡ç« åŠ å¯†"

# æ¨é€åˆ° GitHubï¼ˆè§¦å‘è‡ªåŠ¨éƒ¨ç½²ï¼‰
git push origin main
```

éƒ¨ç½²å®Œæˆåï¼ŒCloudflare Pages ä¼šè‡ªåŠ¨åº”ç”¨ `wrangler.toml` ä¸­çš„é…ç½®ã€‚

### æ­¥éª¤ 4ï¼šè·å– Cloudflare API å‡­è¯

#### 4.1 è·å– Account ID

- åœ¨ Cloudflare Dashboard å³ä¾§å¯ä»¥çœ‹åˆ° **Account ID**
- å¤åˆ¶ä¿å­˜

#### 4.2 åˆ›å»º API Token

1. è¿›å…¥ **My Profile** â†’ **API Tokens**
2. ç‚¹å‡» **Create Token**
3. é€‰æ‹©æ¨¡æ¿ï¼š**Edit Cloudflare Workers**
4. æˆ–è‡ªå®šä¹‰æƒé™ï¼š
   - **Account** â†’ **Workers KV Storage** â†’ **Edit**
5. åˆ›å»ºåå¤åˆ¶ Tokenï¼ˆåªæ˜¾ç¤ºä¸€æ¬¡ï¼Œè¯·å¦¥å–„ä¿å­˜ï¼‰

### æ­¥éª¤ 5ï¼šé…ç½®æœ¬åœ°ç¯å¢ƒ

1. å¤åˆ¶ç¤ºä¾‹é…ç½®æ–‡ä»¶ï¼š
   ```bash
   cp .env.encryption.example .env.encryption
   ```

2. ç¼–è¾‘ `.env.encryption`ï¼Œå¡«å…¥å‡­è¯ï¼š
   ```bash
   CLOUDFLARE_ACCOUNT_ID=your-account-id-here
   CLOUDFLARE_API_TOKEN=your-api-token-here
   CLOUDFLARE_KV_NAMESPACE_ID=your-kv-namespace-id-here
   ```

3. ç¡®ä¿ `.env.encryption` å·²æ·»åŠ åˆ° `.gitignore`ï¼ˆå·²é»˜è®¤æ·»åŠ ï¼‰

---

## ä½¿ç”¨æµç¨‹

### æ–¹å¼ 1ï¼šä½¿ç”¨ç®¡ç†åå°ï¼ˆæ¨èï¼‰â­

**å¯è§†åŒ–ç®¡ç†ï¼Œè‡ªåŠ¨ç”Ÿæˆå¼ºå¯†ç ï¼Œæ— éœ€å‘½ä»¤è¡Œï¼**

1. **è®¿é—®ç®¡ç†åå°**ï¼š`https://your-blog.pages.dev/admin/encryption`
2. **ç™»å½•**ï¼ˆä½¿ç”¨ç®¡ç†å‘˜å¯†ç ï¼‰
3. **é€‰æ‹©æ–‡ç«  â†’ ç‚¹å‡»"å¯ç”¨åŠ å¯†"**
4. **ç³»ç»Ÿè‡ªåŠ¨ç”Ÿæˆå¼ºå¯†ç å¹¶æ˜¾ç¤º**
5. **å¤åˆ¶å¯†ç å’Œé…ç½®ä»£ç **
6. **æ‰‹åŠ¨æ›´æ–°æ–‡ç«  frontmatter**
7. **æäº¤å¹¶éƒ¨ç½²**

**è¯¦ç»†æŒ‡å—**ï¼šæŸ¥çœ‹ [ADMIN_DASHBOARD_GUIDE.md](./ADMIN_DASHBOARD_GUIDE.md)

---

### æ–¹å¼ 2ï¼šä½¿ç”¨ CLI å·¥å…·

#### 1. ä¸ºæ–‡ç« è®¾ç½®å¯†ç 

ä½¿ç”¨ CLI å·¥å…·è®¾ç½®å¯†ç ï¼š

```bash
pnpm manage-password set my-secret-post MyPassword123
```

**å‚æ•°è¯´æ˜ï¼š**
- `my-secret-post`: åŠ å¯† IDï¼ˆencryptionIdï¼‰ï¼Œè‡ªå®šä¹‰å‘½åï¼Œå»ºè®®ä½¿ç”¨æ–‡ç«  slug
- `MyPassword123`: å¯†ç ï¼ˆå»ºè®®ä½¿ç”¨å¼ºå¯†ç ï¼‰

**æˆåŠŸåä¼šæ˜¾ç¤ºï¼š**
```
âœ… å¯†ç è®¾ç½®æˆåŠŸï¼

åœ¨æ–‡ç« çš„ frontmatter ä¸­æ·»åŠ ï¼š
---
encrypted: true
encryptionId: "my-secret-post"
---
```

### 2. åœ¨æ–‡ç« ä¸­å¯ç”¨åŠ å¯†

ç¼–è¾‘æ–‡ç« çš„ frontmatterï¼š

```yaml
---
title: æˆ‘çš„ç§˜å¯†æ–‡ç« 
published: 2025-11-18
encrypted: true
encryptionId: "my-secret-post"
---

# è¿™æ˜¯åŠ å¯†å†…å®¹

è¿™äº›å†…å®¹åªæœ‰è¾“å…¥æ­£ç¡®å¯†ç æ‰èƒ½æŸ¥çœ‹ã€‚
```

**é‡è¦æç¤ºï¼š**
- âœ… `encryptionId` å¿…é¡»ä¸ CLI è®¾ç½®çš„ ID ä¸€è‡´
- âš ï¸ **ä¸è¦**åœ¨ frontmatter ä¸­å†™ `password` å­—æ®µï¼ˆå·²å¼ƒç”¨ï¼‰
- âœ… `encryptionId` å¯ä»¥ç›¸åŒï¼Œå¤šç¯‡æ–‡ç« å…±ç”¨ä¸€ä¸ªå¯†ç 

### 3. æ„å»ºå¹¶éƒ¨ç½²

```bash
pnpm build
```

éƒ¨ç½²åˆ° Cloudflare Pages åï¼Œè®¿é—®åŠ å¯†æ–‡ç« å³å¯çœ‹åˆ°å¯†ç è¾“å…¥ç•Œé¢ã€‚

### 4. ç®¡ç†å¯†ç 

#### æŸ¥çœ‹æ‰€æœ‰åŠ å¯†æ–‡ç« 

```bash
pnpm manage-password list
```

**è¾“å‡ºç¤ºä¾‹ï¼š**
```
ğŸ“‹ æ­£åœ¨è·å–æ‰€æœ‰åŠ å¯†æ–‡ç« ...

æ‰¾åˆ° 2 ä¸ªåŠ å¯†æ–‡ç« ï¼š

  - my-secret-post
  - team-internal-doc
```

#### æ›´æ–°å¯†ç 

```bash
pnpm manage-password set my-secret-post NewPassword456
```

#### åˆ é™¤å¯†ç ï¼ˆå–æ¶ˆåŠ å¯†ï¼‰

```bash
pnpm manage-password delete my-secret-post
```

ç„¶ååœ¨æ–‡ç«  frontmatter ä¸­ç§»é™¤æˆ–è®¾ç½® `encrypted: false`ã€‚

---

## ä½¿ç”¨ç¤ºä¾‹

### ç¤ºä¾‹ 1ï¼šä¸ªäººæ—¥è®°

```yaml
---
title: 2025 å¹´ 11 æœˆæ—¥è®°
published: 2025-11-18
encrypted: true
encryptionId: "diary-2025-11"
tags: [æ—¥è®°, ç§å¯†]
category: ç”Ÿæ´»
---

# ä»Šå¤©çš„å¿ƒæƒ…

è¿™æ˜¯æˆ‘çš„ç§å¯†æ—¥è®°ï¼Œåªæœ‰æˆ‘è‡ªå·±èƒ½çœ‹...
```

**è®¾ç½®å¯†ç ï¼š**
```bash
pnpm manage-password set diary-2025-11 MyDiaryPass2025
```

---

### ç¤ºä¾‹ 2ï¼šå›¢é˜Ÿå†…éƒ¨æ–‡æ¡£

```yaml
---
title: é¡¹ç›®æŠ€æœ¯æ–¹æ¡ˆ
published: 2025-11-18
encrypted: true
encryptionId: "team-doc-project-alpha"
visibility: "unlisted"  # é¢å¤–éšè—ï¼šä¸å‡ºç°åœ¨åˆ—è¡¨ä¸­
hideFromSearch: true    # ä¸è¢«æœç´¢åˆ°
seoNoIndex: true        # æœç´¢å¼•æ“ä¸ç´¢å¼•
---

# é¡¹ç›® Alpha æŠ€æœ¯æ–¹æ¡ˆ

**å›¢é˜Ÿå†…éƒ¨æ–‡æ¡£ï¼Œè¯·å‹¿å¤–ä¼ **
```

**è®¾ç½®å¯†ç ï¼š**
```bash
pnpm manage-password set team-doc-project-alpha TeamPassword123
```

---

### ç¤ºä¾‹ 3ï¼šå¤šç¯‡æ–‡ç« å…±ç”¨å¯†ç 

**åœºæ™¯ï¼š** ä¸€ä¸ªç³»åˆ—æ•™ç¨‹ï¼Œæ‰€æœ‰æ–‡ç« ä½¿ç”¨åŒä¸€ä¸ªå¯†ç 

**æ–‡ç«  1ï¼š**
```yaml
---
title: VIP æ•™ç¨‹ - ç¬¬ä¸€è¯¾
encrypted: true
encryptionId: "vip-tutorial-series"
series: VIP æ•™ç¨‹
---
```

**æ–‡ç«  2ï¼š**
```yaml
---
title: VIP æ•™ç¨‹ - ç¬¬äºŒè¯¾
encrypted: true
encryptionId: "vip-tutorial-series"  # ç›¸åŒçš„ ID
series: VIP æ•™ç¨‹
---
```

**åªéœ€è®¾ç½®ä¸€æ¬¡å¯†ç ï¼š**
```bash
pnpm manage-password set vip-tutorial-series VIPPass2025
```

æ‰€æœ‰ä½¿ç”¨ `vip-tutorial-series` çš„æ–‡ç« éƒ½ä¼šç”¨è¿™ä¸ªå¯†ç éªŒè¯ã€‚

---

## å¸¸è§é—®é¢˜

### Q1: å¯†ç å­˜å‚¨åœ¨å“ªé‡Œï¼Ÿ

**A:** å¯†ç ä»¥ SHA-256 å“ˆå¸Œå½¢å¼å­˜å‚¨åœ¨ Cloudflare KV ä¸­ï¼Œæ ¼å¼å¦‚ä¸‹ï¼š
- **é”®**: `post:encryptionId:password`
- **å€¼**: SHA-256 å“ˆå¸Œå­—ç¬¦ä¸²

å³ä½¿æœ‰äººè®¿é—® KVï¼Œä¹Ÿæ— æ³•åæ¨å‡ºåŸå¯†ç ã€‚

---

### Q2: ç”¨æˆ·è¾“å…¥å¯†ç åå¦‚ä½•éªŒè¯ï¼Ÿ

**A:**
1. ç”¨æˆ·è¾“å…¥å¯†ç 
2. å‰ç«¯è°ƒç”¨ `/api/verify-password` (Cloudflare Workers)
3. Workers è®¡ç®—å¯†ç å“ˆå¸Œå¹¶ä¸ KV ä¸­çš„å“ˆå¸Œæ¯”è¾ƒ
4. éªŒè¯æˆåŠŸåè¿”å›ä¸´æ—¶ä»¤ç‰Œï¼ˆ1 å°æ—¶æœ‰æ•ˆï¼‰
5. å‰ç«¯ä¿å­˜ä»¤ç‰Œåˆ° localStorage å¹¶åˆ·æ–°é¡µé¢

---

### Q3: éªŒè¯æˆåŠŸåéœ€è¦æ¯æ¬¡éƒ½è¾“å…¥å¯†ç å—ï¼Ÿ

**A:** ä¸éœ€è¦ã€‚éªŒè¯æˆåŠŸåä¼šç”Ÿæˆä¸´æ—¶ä»¤ç‰Œå¹¶ä¿å­˜åˆ°æµè§ˆå™¨ localStorageï¼Œ1 å°æ—¶å†…è®¿é—®ç›¸åŒæ–‡ç« æ— éœ€é‡æ–°è¾“å…¥å¯†ç ã€‚

---

### Q4: å¦‚ä½•é‡ç½®æ‰€æœ‰å¯†ç ï¼Ÿ

**A:**
```bash
# åˆ—å‡ºæ‰€æœ‰åŠ å¯†æ–‡ç« 
pnpm manage-password list

# é€ä¸ªåˆ é™¤
pnpm manage-password delete article-id-1
pnpm manage-password delete article-id-2
```

æˆ–è€…ç›´æ¥åœ¨ Cloudflare Dashboard ä¸­æ¸…ç©º KV å‘½åç©ºé—´ã€‚

---

### Q5: æœ¬åœ°å¼€å‘æ—¶å¦‚ä½•æµ‹è¯•ï¼Ÿ

**A:** æœ¬åœ°å¼€å‘ (`pnpm dev`) æ—¶æ— æ³•è°ƒç”¨ Cloudflare Workers APIï¼Œéœ€è¦ï¼š

**æ–¹æ³• 1ï¼š** ä½¿ç”¨ `wrangler` æœ¬åœ°æ¨¡æ‹Ÿ Workers
```bash
pnpm wrangler dev
```

**æ–¹æ³• 2ï¼š** éƒ¨ç½²åˆ° Cloudflare Pages Preview ç¯å¢ƒæµ‹è¯•

**æ–¹æ³• 3ï¼š** ä¸´æ—¶ä½¿ç”¨æ—§çš„å‰ç«¯åŠ å¯†æ–¹æ¡ˆï¼ˆä¸æ¨èï¼‰

---

### Q6: å¿˜è®°å¯†ç æ€ä¹ˆåŠï¼Ÿ

**A:** å¯†ç åªå­˜å‚¨å“ˆå¸Œï¼Œæ— æ³•æ‰¾å›åŸå¯†ç ã€‚åªèƒ½é‡æ–°è®¾ç½®ï¼š

```bash
pnpm manage-password set article-id NewPassword123
```

---

### Q7: åŠ å¯†ä¼šå½±å“ SEO å—ï¼Ÿ

**A:** ä¸ä¼šã€‚æœç´¢å¼•æ“çˆ¬è™«çœ‹åˆ°çš„ä»ç„¶æ˜¯å®Œæ•´çš„é¡µé¢ï¼ˆåŒ…æ‹¬æ¨¡ç³Šçš„å†…å®¹ï¼‰ï¼Œåªæ˜¯ï¼š
- å»ºè®®é…åˆ `seoNoIndex: true` é˜»æ­¢ç´¢å¼•
- å»ºè®®é…åˆ `hideFromSearch: true` éšè—ç«™å†…æœç´¢

---

## å®‰å…¨è¯´æ˜

### âœ… å®‰å…¨çš„åšæ³•

1. **ä½¿ç”¨å¼ºå¯†ç **ï¼šè‡³å°‘ 12 ä½ï¼ŒåŒ…å«å¤§å°å†™å­—æ¯ã€æ•°å­—ã€ç¬¦å·
2. **å®šæœŸæ›´æ¢å¯†ç **ï¼šç‰¹åˆ«æ˜¯åˆ†äº«å¯†ç å
3. **ä¸åŒæ–‡ç« ä½¿ç”¨ä¸åŒå¯†ç **ï¼ˆé™¤éæ˜¯ç³»åˆ—æ–‡ç« ï¼‰
4. **å¦¥å–„ä¿ç®¡ API Token**ï¼šä¸è¦æäº¤åˆ° Gitï¼Œä¸è¦åˆ†äº«ç»™ä»–äºº
5. **ä½¿ç”¨ HTTPS**ï¼šç¡®ä¿å¯†ç ä¼ è¾“åŠ å¯†ï¼ˆCloudflare Pages é»˜è®¤ HTTPSï¼‰

### âš ï¸ æ³¨æ„äº‹é¡¹

1. **API Token æƒé™æœ€å°åŒ–**ï¼šåªæˆäºˆ Workers KV ç¼–è¾‘æƒé™
2. **ä¸´æ—¶ä»¤ç‰Œæœ‰æ•ˆæœŸ**ï¼šé»˜è®¤ 1 å°æ—¶ï¼Œå¯åœ¨ Workers å‡½æ•°ä¸­ä¿®æ”¹
3. **KV è®¿é—®æ§åˆ¶**ï¼šç¡®ä¿ KV å‘½åç©ºé—´åªç»‘å®šåˆ°ä½ çš„ Pages é¡¹ç›®
4. **å¤‡ä»½å¯†ç **ï¼šå»ºè®®ä½¿ç”¨å¯†ç ç®¡ç†å™¨ä¿å­˜å¯†ç ï¼ˆå¦‚ 1Passwordã€Bitwardenï¼‰

### ğŸš« ä¸è¦åšçš„äº‹

1. âŒ ä¸è¦åœ¨æ–‡ç«  frontmatter ä¸­å†™å¯†ç 
2. âŒ ä¸è¦å°† `.env.encryption` æäº¤åˆ° Git
3. âŒ ä¸è¦åœ¨å…¬å¼€æ¸ é“åˆ†äº« API Token
4. âŒ ä¸è¦ä½¿ç”¨å¼±å¯†ç ï¼ˆå¦‚ `123456`ã€`password`ï¼‰
5. âŒ ä¸è¦è®¤ä¸ºåŠ å¯† = ç»å¯¹å®‰å…¨ï¼ˆä»éœ€é…åˆå…¶ä»–éšç§æªæ–½ï¼‰

---

## æŠ€æœ¯æ¶æ„

### æ–‡ä»¶æ¸…å•

```
blog/
â”œâ”€â”€ functions/                      # Cloudflare Workers å‡½æ•°
â”‚   â””â”€â”€ api/
â”‚       â”œâ”€â”€ verify-password.ts      # éªŒè¯å¯†ç  API
â”‚       â””â”€â”€ check-token.ts          # éªŒè¯ä»¤ç‰Œ API
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â””â”€â”€ EncryptedPostGuard.svelte  # å‰ç«¯åŠ å¯†ç»„ä»¶
â”‚   â”œâ”€â”€ content/
â”‚   â”‚   â””â”€â”€ config.ts              # Schema å®šä¹‰ï¼ˆåŒ…å« encryptionIdï¼‰
â”‚   â””â”€â”€ pages/
â”‚       â””â”€â”€ posts/
â”‚           â””â”€â”€ [...slug].astro     # æ–‡ç« è¯¦æƒ…é¡µï¼ˆé›†æˆåŠ å¯†ç»„ä»¶ï¼‰
â”œâ”€â”€ scripts/
â”‚   â””â”€â”€ manage-password.mjs         # å¯†ç ç®¡ç† CLI
â”œâ”€â”€ .env.encryption.example         # ç¯å¢ƒå˜é‡ç¤ºä¾‹
â””â”€â”€ ENCRYPTION_GUIDE.md             # æœ¬æ–‡æ¡£
```

### API ç«¯ç‚¹

| ç«¯ç‚¹ | æ–¹æ³• | è¯´æ˜ |
|------|------|------|
| `/api/verify-password` | POST | éªŒè¯å¯†ç å¹¶ç”Ÿæˆä»¤ç‰Œ |
| `/api/check-token` | POST | éªŒè¯ä»¤ç‰Œæ˜¯å¦æœ‰æ•ˆ |

### æ•°æ®æµ

```
ç”¨æˆ·è¾“å…¥å¯†ç 
    â†“
å‰ç«¯è°ƒç”¨ /api/verify-password
    â†“
Workers ä» KV è·å–å¯†ç å“ˆå¸Œ
    â†“
è®¡ç®—è¾“å…¥å¯†ç çš„ SHA-256 å“ˆå¸Œ
    â†“
æ¯”è¾ƒå“ˆå¸Œå€¼
    â†“
ç”Ÿæˆä¸´æ—¶ä»¤ç‰Œå¹¶å­˜å…¥ KV
    â†“
è¿”å›ä»¤ç‰Œç»™å‰ç«¯
    â†“
å‰ç«¯ä¿å­˜ä»¤ç‰Œåˆ° localStorage
    â†“
åˆ·æ–°é¡µé¢ï¼Œæ˜¾ç¤ºå†…å®¹
```

---

## ç›¸å…³æ–‡æ¡£

- [Cloudflare KV æ–‡æ¡£](https://developers.cloudflare.com/kv/)
- [Cloudflare Workers æ–‡æ¡£](https://developers.cloudflare.com/workers/)
- [Cloudflare Pages Functions æ–‡æ¡£](https://developers.cloudflare.com/pages/functions/)

---

## åé¦ˆä¸æ”¯æŒ

é‡åˆ°é—®é¢˜æˆ–æœ‰æ”¹è¿›å»ºè®®ï¼Ÿè¯·åœ¨ [GitHub Issues](https://github.com/johntime2005/blog/issues) ä¸­åé¦ˆã€‚

**ç¥ä½¿ç”¨æ„‰å¿«ï¼ğŸš€**
